<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cashflow Online | Edi√ß√£o Completa</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2C3E50;
            --secondary: #3498DB;
            --success: #2ECC71;
            --danger: #E74C3C;
            --warning: #F39C12;
            --light: #ECF0F1;
            --dark: #2C3E50;
            --player1: #E74C3C;
            --player2: #3498DB;
            --player3: #2ECC71;
            --player4: #9B59B6;
            --player5: #F39C12;
            --player6: #1ABC9C;
        }

        body {
            background: linear-gradient(135deg, #1a2a3a, #2c3e50);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* CONFIGURA√á√ÉO INICIAL */
        .setup-screen {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid var(--warning);
            max-width: 800px;
            margin: 20px auto;
        }

        .setup-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-weight: bold;
            color: var(--warning);
        }

        .form-group input,
        .form-group select {
            padding: 12px;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }

        .player-names-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        /* TABELA DO TABULEIRO */
        .board-table-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            border: 2px solid var(--secondary);
        }

        .board-table {
            width: 100%;
            border-collapse: collapse;
            margin: 0 auto;
        }

        .board-table th {
            background: var(--secondary);
            color: white;
            padding: 12px;
            text-align: center;
            font-size: 0.9rem;
            position: sticky;
            top: 0;
        }

        .board-table td {
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            vertical-align: middle;
            min-width: 120px;
            position: relative;
        }

        .board-table td:first-child {
            width: 40px;
            min-width: 40px;
        }

        .space-number {
            font-weight: bold;
            font-size: 0.9rem;
            color: var(--warning);
            padding: 2px 4px;
            background: rgba(243, 156, 18, 0.2);
            border-radius: 4px;
            display: inline-block;
            width: 30px;
        }

        .space-type {
            font-size: 0.8rem;
            margin: 3px 0;
        }

        .space-action {
            font-size: 0.75rem;
            color: #bdc3c7;
        }

        .player-markers-cell {
            min-width: 180px;
        }

        /* Cores dos espa√ßos */
        .space-start { background: rgba(243, 156, 18, 0.15); border-left: 4px solid var(--warning); }
        .space-small { background: rgba(52, 152, 219, 0.15); border-left: 4px solid var(--player2); }
        .space-big { background: rgba(52, 152, 219, 0.2); border-left: 4px solid var(--secondary); }
        .space-doodad { background: rgba(231, 76, 60, 0.25); border-left: 4px solid var(--player1); }
        .space-market { background: rgba(46, 204, 113, 0.15); border-left: 4px solid var(--success); }
        .space-payday { background: rgba(155, 89, 182, 0.15); border-left: 4px solid var(--player4); }
        .space-baby { background: rgba(241, 196, 15, 0.15); border-left: 4px solid #F1C40F; }
        .space-charity { background: rgba(230, 126, 34, 0.15); border-left: 4px solid #E67E22; }
        .space-dream { background: rgba(155, 89, 182, 0.25); border-left: 4px solid #9b59b6; }

        /* Marcadores dos jogadores */
        .player-markers {
            display: flex;
            justify-content: center;
            gap: 3px;
            margin-top: 5px;
            flex-wrap: wrap;
        }

        .player-marker {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            font-weight: bold;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        /* CONTROLES */
        .controls {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            border: 2px solid var(--secondary);
        }

        .dice-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .dice {
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            color: var(--dark);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            user-select: none;
        }

        .dice.rolling {
            animation: roll 0.5s infinite;
        }

        @keyframes roll {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .button {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .button-success { background: var(--success); }
        .button-danger { background: var(--danger); }
        .button-warning { background: var(--warning); }
        .button-purple { background: #9b59b6; }

        /* CARD DISPLAY */
        .card-display {
            background: white;
            color: var(--dark);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            display: none;
            border-top: 8px solid var(--secondary);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }

        .card-title {
            color: var(--secondary);
            font-size: 1.3rem;
            font-weight: bold;
        }

        .card-phase {
            background: #f39c12;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .card-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .card-detail {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid var(--secondary);
        }

        .detail-label {
            font-size: 0.85rem;
            color: #666;
        }

        .detail-value {
            font-size: 1.1rem;
            font-weight: bold;
            margin-top: 5px;
        }

        .card-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        /* LOG */
        .log-section {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid var(--secondary);
        }

        .log-content {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
        }

        .log-entry {
            padding: 6px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.85rem;
        }

        /* MODAL */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            color: var(--dark);
            border-radius: 15px;
            padding: 25px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .modal-title {
            color: var(--secondary);
            font-size: 1.4rem;
            font-weight: bold;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--danger);
        }

        /* INFORMA√á√ïES DO JOGADOR ATUAL */
        .player-info-bar {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid var(--warning);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .player-info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .info-label {
            font-size: 0.8rem;
            color: #bdc3c7;
            margin-bottom: 3px;
            text-align: center;
        }

        .info-value {
            font-size: 1.1rem;
            font-weight: bold;
            text-align: center;
        }

        .info-income { color: var(--success); }
        .info-expense { color: var(--danger); }
        .info-warning { color: var(--warning); }

        /* DEBT INDICATOR */
        .debt-indicator {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid var(--danger);
            border-radius: 20px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            color: var(--danger);
            grid-column: 1 / -1;
            justify-content: center;
        }

        .phase-indicator {
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid var(--secondary);
            border-radius: 20px;
            padding: 5px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            color: var(--secondary);
        }

        /* RESPONSIVO */
        @media (max-width: 768px) {
            .board-table {
                font-size: 0.8rem;
            }
            
            .board-table th,
            .board-table td {
                padding: 6px;
            }
            
            .board-table td:first-child {
                width: 30px;
                min-width: 30px;
            }
            
            .space-number {
                width: 25px;
                font-size: 0.8rem;
            }
            
            .player-markers-cell {
                min-width: 120px;
            }
            
            .dice {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .button {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .player-info-bar {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .debt-indicator {
                grid-column: 1;
            }
        }

        /* CORES DOS JOGADORES */
        .color-1 { background: var(--player1); }
        .color-2 { background: var(--player2); }
        .color-3 { background: var(--player3); }
        .color-4 { background: var(--player4); }
        .color-5 { background: var(--player5); }
        .color-6 { background: var(--player6); }

        /* ANIMA√á√ïES */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse-warning {
            animation: pulse 1s infinite;
        }

        /* GAME STATS */
        .game-stats {
            display: flex;
            justify-content: space-around;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
            font-size: 0.9rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-weight: bold;
            color: var(--warning);
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- TELA DE CONFIGURA√á√ÉO -->
        <div id="setupScreen" class="setup-screen">
            <h2 style="color: var(--warning); text-align: center; margin-bottom: 20px;">
                <i class="fas fa-cogs"></i> CONFIGURA√á√ÉO DO JOGO
            </h2>
            
            <div class="setup-form">
                <div class="form-group">
                    <label><i class="fas fa-users"></i> N√öMERO DE JOGADORES (2-6)</label>
                    <select id="numPlayers">
                        <option value="2">2 Jogadores</option>
                        <option value="3">3 Jogadores</option>
                        <option value="4">4 Jogadores</option>
                        <option value="5">5 Jogadores</option>
                        <option value="6">6 Jogadores</option>
                    </select>
                </div>
                
                <div id="playerNamesContainer" class="player-names-container">
                    <!-- Nomes ser√£o gerados aqui -->
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="button button-warning" id="startGameBtn" style="padding: 15px 40px; font-size: 1.1rem;">
                        <i class="fas fa-play"></i> INICIAR JOGO
                    </button>
                </div>
            </div>
        </div>

        <!-- √ÅREA DO JOGO (inicialmente escondida) -->
        <div id="gameArea" style="display: none;">
            <header style="text-align: center; margin-bottom: 20px;">
                <h1 style="color: var(--warning); font-size: 2rem;">
                    <i class="fas fa-coins"></i> CASHFLOW ONLINE - EDI√á√ÉO COMPLETA
                </h1>
                <p style="color: var(--light);">Dinheiro inicial 180% | Doodads por fase | Juros por volta</p>
            </header>

            <!-- INFORMA√á√ïES DO JOGO -->
            <div class="game-stats">
                <div class="stat-item">
                    <div>Rodada Atual</div>
                    <div class="stat-value" id="currentRound">1</div>
                </div>
                <div class="stat-item">
                    <div>Fase do Jogo</div>
                    <div class="stat-value" id="gamePhase">FASE 1 - IN√çCIO</div>
                </div>
                <div class="stat-item">
                    <div>Total de Voltas</div>
                    <div class="stat-value" id="totalLaps">0</div>
                </div>
            </div>

            <!-- INFORMA√á√ïES DO JOGADOR ATUAL -->
            <div class="player-info-bar" id="currentPlayerInfo">
                <!-- Informa√ß√µes ser√£o inseridas aqui -->
            </div>

            <!-- TABELA DO TABULEIRO -->
            <div class="board-table-container">
                <h3 style="color: var(--warning); margin-bottom: 15px; text-align: center;">
                    <i class="fas fa-table"></i> TABULEIRO - 40 ESPA√áOS
                </h3>
                <table class="board-table" id="boardTable">
                    <!-- Gerado dinamicamente -->
                </table>
            </div>

            <!-- TABELA DA VIA R√ÅPIDA -->
            <div class="board-table-container" id="fastTrackTable" style="display: none; border-color: #f39c12;">
                <h3 style="color: #f39c12; margin-bottom: 15px; text-align: center;">
                    <i class="fas fa-bolt"></i> VIA R√ÅPIDA - PARA JOGADORES QUE SA√çRAM DA CORRIDA DOS RATOS
                </h3>
                <table class="board-table">
                    <thead>
                        <tr>
                            <th>ESPA√áO</th>
                            <th>OPORTUNIDADE</th>
                            <th>PR√äMIO</th>
                            <th>JOGADORES</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="space-dream">
                            <td><span class="space-number">0</span></td>
                            <td><span class="space-type">ENTRADA NA VIA R√ÅPIDA</span></td>
                            <td><span class="space-action">Receba R$ 100.000 para investir!</span></td>
                            <td id="fastTrackMarker0" class="player-markers-cell"></td>
                        </tr>
                        <tr class="space-dream">
                            <td><span class="space-number">1</span></td>
                            <td><span class="space-type">INVESTIMENTO PRIVADO</span></td>
                            <td><span class="space-action">Invista R$ 50.000 para ganhar R$ 500/m√™s</span></td>
                            <td id="fastTrackMarker1" class="player-markers-cell"></td>
                        </tr>
                        <tr class="space-dream">
                            <td><span class="space-number">2</span></td>
                            <td><span class="space-type">MERCADO DE A√á√ïES</span></td>
                            <td><span class="space-action">Compre a√ß√µes com 30% de desconto</span></td>
                            <td id="fastTrackMarker2" class="player-markers-cell"></td>
                        </tr>
                        <tr class="space-dream">
                            <td><span class="space-number">3</span></td>
                            <td><span class="space-type">FII DE LUXO</span></td>
                            <td><span class="space-action">Fundos imobili√°rios premium</span></td>
                            <td id="fastTrackMarker3" class="player-markers-cell"></td>
                        </tr>
                        <tr class="space-dream">
                            <td><span class="space-number">4</span></td>
                            <td><span class="space-type">SONHO DISPON√çVEL</span></td>
                            <td><span class="space-action">Realize um sonho se tiver renda suficiente</span></td>
                            <td id="fastTrackMarker4" class="player-markers-cell"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- CONTROLES -->
            <div class="controls">
                <h3 style="color: var(--warning); margin-bottom: 15px; text-align: center;">
                    <i class="fas fa-gamepad"></i> CONTROLES
                </h3>
                
                <div class="dice-container">
                    <div class="dice" id="dice1">?</div>
                    <div class="dice" id="dice2">?</div>
                </div>
                
                <div>
                    <button class="button button-warning" id="rollDiceBtn">
                        <i class="fas fa-dice"></i> ROLAR DADOS
                    </button>
                    
                    <button class="button" id="endTurnBtn" disabled>
                        <i class="fas fa-forward"></i> FINALIZAR TURNO
                    </button>
                    
                    <button class="button button-success" id="showAssetsBtn">
                        <i class="fas fa-chart-pie"></i> MEUS ATIVOS
                    </button>
                    
                    <button class="button button-purple" id="payDebtBtn">
                        <i class="fas fa-money-bill-wave"></i> QUITAR D√çVIDAS
                    </button>
                    
                    <button class="button button-danger" id="newGameBtn">
                        <i class="fas fa-redo"></i> NOVO JOGO
                    </button>
                </div>
                
                <div id="winnerMessage" style="margin-top: 15px;"></div>
            </div>

            <!-- √ÅREA DE CARTAS -->
            <div class="card-display" id="cardDisplay">
                <div class="card-header">
                    <div class="card-title" id="cardTitle">OPORTUNIDADE</div>
                    <div class="card-phase" id="cardPhaseTag">FASE 1</div>
                </div>
                
                <div id="cardDescription" style="margin-bottom: 15px;"></div>
                
                <div class="card-details" id="cardDetails">
                    <!-- Detalhes aqui -->
                </div>
                
                <div class="card-actions" id="cardActions">
                    <!-- Bot√µes aqui -->
                </div>
            </div>

            <!-- LOG DO JOGO -->
            <div class="log-section">
                <h3 style="color: var(--warning); margin-bottom: 15px; text-align: center;">
                    <i class="fas fa-history"></i> HIST√ìRICO DO JOGO
                </h3>
                <div class="log-content" id="gameLog">
                    <div class="log-entry">Jogo iniciado!</div>
                </div>
                <div style="text-align: center; margin-top: 10px;">
                    <button class="button" onclick="clearLog()" style="padding: 8px 15px;">
                        <i class="fas fa-trash"></i> Limpar Hist√≥rico
                    </button>
                </div>
            </div>
        </div>

        <!-- MODAL DE ATIVOS -->
        <div class="modal" id="assetsModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title" id="assetsTitle">MEUS ATIVOS E D√çVIDAS</div>
                    <button class="close-modal" onclick="closeModal('assetsModal')">&times;</button>
                </div>
                <div id="assetsContent">
                    <!-- Conte√∫do aqui -->
                </div>
            </div>
        </div>

        <!-- MODAL DE QUITAR D√çVIDAS -->
        <div class="modal" id="debtModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title"><i class="fas fa-money-bill-wave"></i> QUITAR D√çVIDAS</div>
                    <button class="close-modal" onclick="closeModal('debtModal')">&times;</button>
                </div>
                <div id="debtContent">
                    <!-- Conte√∫do aqui -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // =========== CONFIGURA√á√ÉO DO JOGO ===========
        const gameState = {
            currentPlayer: 1,
            gameActive: true,
            diceValue: 0,
            currentCard: null,
            totalPlayers: 2,
            players: {},
            spaces: [],
            dice3Enabled: false,
            charityPlayer: null,
            currentRound: 1,
            gamePhase: 1, // 1, 2 ou 3
            totalLaps: 0
        };

        // =========== PROFISS√ïES COM DINHEIRO INICIAL 180% ===========
        const professions = [
            { name: "Enfermeiro", salary: 3500, expenses: 2800, cashflow: 700, initialCash: 6300 },
            { name: "Professor", salary: 4200, expenses: 3500, cashflow: 700, initialCash: 7560 },
            { name: "Mec√¢nico", salary: 2800, expenses: 2350, cashflow: 450, initialCash: 5040 },
            { name: "Secret√°ria", salary: 3200, expenses: 2650, cashflow: 550, initialCash: 5760 },
            { name: "Policial", salary: 3800, expenses: 3100, cashflow: 700, initialCash: 6840 },
            { name: "Motorista", salary: 3000, expenses: 2500, cashflow: 500, initialCash: 5400 }
        ];

        // =========== DOODADS POR FASE ===========
        const doodadsByPhase = {
            1: [ // FASE 1 ‚Äî IN√çCIO (Rodadas 1 a 8)
                { name: "Celular novo", cost: 300, monthly: 0, description: "Smartphone b√°sico" },
                { name: "Roupas", cost: 400, monthly: 0, description: "Roupas novas para trabalho" },
                { name: "Jantar fora", cost: 500, monthly: 0, description: "Jantar em restaurante chique" },
                { name: "Manuten√ß√£o carro", cost: 600, monthly: 0, description: "Reparos no ve√≠culo" },
                { name: "Pequena viagem", cost: 800, monthly: 0, description: "Fim de semana na praia" },
                { name: "Eletr√¥nicos", cost: 1000, monthly: 0, description: "Tablet e acess√≥rios" }
            ],
            2: [ // FASE 2 ‚Äî MEIO DO JOGO (Rodadas 9 a 20)
                { name: "Smartphone premium", cost: 1200, monthly: 100, description: "√öltimo modelo parcelado" },
                { name: "TV grande", cost: 1800, monthly: 150, description: "TV 55'' 4K em 12x" },
                { name: "Moto financiada", cost: 2500, monthly: 250, description: "Moto 0km financiada" },
                { name: "Curso caro", cost: 2000, monthly: 0, description: "Curso de especializa√ß√£o" },
                { name: "Viagem internacional", cost: 3000, monthly: 0, description: "1 semana no exterior" }
            ],
            3: [ // FASE 3 ‚Äî AVAN√áADO (Ap√≥s rodada 20)
                { name: "Carro novo", cost: 4000, monthly: 400, description: "Carro 0km financiado" },
                { name: "Reforma casa", cost: 5000, monthly: 0, description: "Reforma completa" },
                { name: "Barco", cost: 6000, monthly: 500, description: "Barco de recreio" },
                { name: "Casa maior", cost: 8000, monthly: 800, description: "Mudan√ßa para casa maior" },
                { name: "Luxo excessivo", cost: 10000, monthly: 1000, description: "Gastos de luxo desnecess√°rios" }
            ]
        };

        // =========== CONFIGURA√á√ÉO INICIAL ===========
        function initializeGame() {
            setupPlayerNames();
            
            document.getElementById('numPlayers').addEventListener('change', setupPlayerNames);
            document.getElementById('startGameBtn').addEventListener('click', startGame);
            document.getElementById('rollDiceBtn').addEventListener('click', rollDice);
            document.getElementById('endTurnBtn').addEventListener('click', endTurn);
            document.getElementById('showAssetsBtn').addEventListener('click', showAssets);
            document.getElementById('payDebtBtn').addEventListener('click', showDebtModal);
            document.getElementById('newGameBtn').addEventListener('click', () => location.reload());
        }

        function setupPlayerNames() {
            const numPlayers = parseInt(document.getElementById('numPlayers').value);
            const container = document.getElementById('playerNamesContainer');
            container.innerHTML = '';
            
            for (let i = 1; i <= numPlayers; i++) {
                const div = document.createElement('div');
                div.className = 'form-group';
                div.innerHTML = `
                    <label>Jogador ${i}:</label>
                    <input type="text" id="playerName${i}" value="Jogador ${i}" placeholder="Nome do jogador">
                `;
                container.appendChild(div);
            }
        }

        function getRandomProfession() {
            return professions[Math.floor(Math.random() * professions.length)];
        }

        function startGame() {
            const numPlayers = parseInt(document.getElementById('numPlayers').value);
            gameState.totalPlayers = numPlayers;
            gameState.players = {};
            gameState.currentRound = 1;
            gameState.gamePhase = 1;
            gameState.totalLaps = 0;
            
            for (let i = 1; i <= numPlayers; i++) {
                const name = document.getElementById(`playerName${i}`).value || `Jogador ${i}`;
                const prof = getRandomProfession();
                
                gameState.players[i] = {
                    id: i,
                    name: name,
                    profession: prof.name,
                    salary: prof.salary,
                    expenses: prof.expenses,
                    cashflow: prof.cashflow,
                    cash: prof.initialCash,
                    passiveIncome: 0,
                    position: 0,
                    inRatRace: true,
                    assets: [],
                    liabilities: [],
                    loans: [],
                    dreams: [],
                    hasCharityBonus: false,
                    lapsCompleted: 0
                };
            }
            
            createBoard();
            document.getElementById('setupScreen').style.display = 'none';
            document.getElementById('gameArea').style.display = 'block';
            
            updateBoard();
            updateCurrentPlayerInfo();
            updateGameStats();
            
            addLog("üéÆ JOGO INICIADO COM NOVAS REGRAS!");
            addLog("üí∞ Dinheiro inicial: 180% do sal√°rio");
            addLog("üè¶ Juros: 10% por VOLTA no tabuleiro");
            addLog("üì± Doodads por fase do jogo");
            
            for (let i = 1; i <= numPlayers; i++) {
                const player = gameState.players[i];
                addLog(`üë§ ${player.name} √© ${player.profession} (Sal√°rio: R$ ${player.salary.toLocaleString()}, Inicial: R$ ${player.cash.toLocaleString()})`);
            }
            addLog(`üé≤ Vez de: ${gameState.players[1].name}`);
        }

        // =========== TABULEIRO ===========
        function createBoard() {
            gameState.spaces = [];
            
            const spaceTypes = [
                'start', 'small', 'payday', 'market', 'doodad', 'baby', 'charity', 'big',
                'payday', 'market', 'small', 'doodad', 'baby', 'charity', 'big', 'payday',
                'market', 'small', 'doodad', 'baby', 'charity', 'big', 'payday', 'market',
                'small', 'doodad', 'baby', 'charity', 'big', 'payday', 'market', 'small',
                'doodad', 'baby', 'charity', 'big', 'payday', 'market', 'small', 'dream'
            ];
            
            const spaceNames = [
                'IN√çCIO', 'PEQUENA OPORTUNIDADE', 'DIA DE PAGAMENTO', 'MERCADO', 'DOODAD', 'BEB√ä', 'CARIDADE', 'GRANDE OPORTUNIDADE',
                'DIA DE PAGAMENTO', 'MERCADO', 'PEQUENA OPORTUNIDADE', 'DOODAD', 'BEB√ä', 'CARIDADE', 'GRANDE OPORTUNIDADE', 'DIA DE PAGAMENTO',
                'MERCADO', 'PEQUENA OPORTUNIDADE', 'DOODAD', 'BEB√ä', 'CARIDADE', 'GRANDE OPORTUNIDADE', 'DIA DE PAGAMENTO', 'MERCADO',
                'PEQUENA OPORTUNIDADE', 'DOODAD', 'BEB√ä', 'CARIDADE', 'GRANDE OPORTUNIDADE', 'DIA DE PAGAMENTO', 'MERCADO', 'PEQUENA OPORTUNIDADE',
                'DOODAD', 'BEB√ä', 'CARIDADE', 'GRANDE OPORTUNIDADE', 'DIA DE PAGAMENTO', 'MERCADO', 'PEQUENA OPORTUNIDADE', 'VIA R√ÅPIDA'
            ];
            
            const spaceActions = [
                'Comece aqui!', 'Compre a√ß√µes ou t√≠tulos', 'Receba sal√°rio', 'Venda ou compre ativos', 'Gasto obrigat√≥rio!',
                'Despesas aumentam', 'Doa√ß√£o 10% do sal√°rio', 'Compre im√≥veis ou neg√≥cios', 'Receba sal√°rio', 'Venda ou compre ativos',
                'Compre a√ß√µes ou t√≠tulos', 'Gasto obrigat√≥rio!', 'Despesas aumentam', 'Doa√ß√£o 10% do sal√°rio', 'Compre im√≥veis ou neg√≥cios',
                'Receba sal√°rio', 'Venda ou compre ativos', 'Compre a√ß√µes ou t√≠tulos', 'Gasto obrigat√≥rio!', 'Despesas aumentam',
                'Doa√ß√£o 10% do sal√°rio', 'Compre im√≥veis ou neg√≥cios', 'Receba sal√°rio', 'Venda ou compre ativos', 'Compre a√ß√µes ou t√≠tulos',
                'Gasto obrigat√≥rio!', 'Despesas aumentam', 'Doa√ß√£o 10% do sal√°rio', 'Compre im√≥veis ou neg√≥cios', 'Receba sal√°rio',
                'Venda ou compre ativos', 'Compre a√ß√µes ou t√≠tulos', 'Gasto obrigat√≥rio!', 'Despesas aumentam', 'Doa√ß√£o 10% do sal√°rio',
                'Compre im√≥veis ou neg√≥cios', 'Receba sal√°rio', 'Venda ou compre ativos', 'Compre a√ß√µes ou t√≠tulos', 'Compre um sonho!'
            ];
            
            for (let i = 0; i < 40; i++) {
                gameState.spaces.push({
                    num: i,
                    type: spaceTypes[i],
                    name: spaceNames[i],
                    action: spaceActions[i]
                });
            }
            
            const table = document.getElementById('boardTable');
            let html = `
                <thead>
                    <tr>
                        <th>ESPA√áO</th>
                        <th>TIPO</th>
                        <th>A√á√ÉO</th>
                        <th>JOGADORES</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            for (let i = 0; i < 40; i++) {
                const space = gameState.spaces[i];
                html += `
                    <tr class="space-${space.type}">
                        <td><span class="space-number">${space.num}</span></td>
                        <td><span class="space-type">${space.name}</span></td>
                        <td><span class="space-action">${space.action}</span></td>
                        <td id="spaceMarkers${i}" class="player-markers-cell">
                            <div class="player-markers" id="markers${i}"></div>
                        </td>
                    </tr>
                `;
            }
            
            html += '</tbody>';
            table.innerHTML = html;
        }

        function updateBoard() {
            for (let i = 0; i < 40; i++) {
                const markersDiv = document.getElementById(`markers${i}`);
                if (markersDiv) markersDiv.innerHTML = '';
            }
            
            for (let playerId = 1; playerId <= gameState.totalPlayers; playerId++) {
                const player = gameState.players[playerId];
                const markersDiv = document.getElementById(`markers${player.position}`);
                
                if (markersDiv) {
                    const marker = document.createElement('div');
                    marker.className = `player-marker color-${playerId}`;
                    marker.textContent = playerId;
                    marker.title = player.name;
                    markersDiv.appendChild(marker);
                }
            }
            
            // Atualiza a via r√°pida
            updateFastTrack();
        }

        // =========== ATUALIZAR VIA R√ÅPIDA ===========
        function updateFastTrack() {
            // Esconde a tabela se nenhum jogador est√° na via r√°pida
            let hasFastTrackPlayers = false;
            
            for (let playerId = 1; playerId <= gameState.totalPlayers; playerId++) {
                if (!gameState.players[playerId].inRatRace) {
                    hasFastTrackPlayers = true;
                    break;
                }
            }
            
            const fastTrackTable = document.getElementById('fastTrackTable');
            fastTrackTable.style.display = hasFastTrackPlayers ? 'block' : 'none';
            
            // Limpa todos os marcadores
            for (let i = 0; i < 5; i++) {
                const markersDiv = document.getElementById(`fastTrackMarker${i}`);
                if (markersDiv) markersDiv.innerHTML = '';
            }
            
            // Adiciona marcadores dos jogadores na via r√°pida
            for (let playerId = 1; playerId <= gameState.totalPlayers; playerId++) {
                const player = gameState.players[playerId];
                
                if (!player.inRatRace) {
                    // Jogadores na via r√°pida ficam no espa√ßo 0 (entrada)
                    const markersDiv = document.getElementById(`fastTrackMarker0`);
                    
                    if (markersDiv) {
                        const marker = document.createElement('div');
                        marker.className = `player-marker color-${playerId}`;
                        marker.textContent = playerId;
                        marker.title = player.name + " (Via R√°pida)";
                        markersDiv.appendChild(marker);
                    }
                }
            }
        }

        // =========== ATUALIZAR ESTAT√çSTICAS DO JOGO ===========
        function updateGameStats() {
            // Atualiza fase baseado na rodada
            if (gameState.currentRound <= 8) {
                gameState.gamePhase = 1;
                document.getElementById('gamePhase').textContent = "FASE 1 - IN√çCIO";
                document.getElementById('gamePhase').style.color = "#2ecc71";
            } else if (gameState.currentRound <= 20) {
                gameState.gamePhase = 2;
                document.getElementById('gamePhase').textContent = "FASE 2 - MEIO DO JOGO";
                document.getElementById('gamePhase').style.color = "#f39c12";
            } else {
                gameState.gamePhase = 3;
                document.getElementById('gamePhase').textContent = "FASE 3 - AVAN√áADO";
                document.getElementById('gamePhase').style.color = "#e74c3c";
            }
            
            document.getElementById('currentRound').textContent = gameState.currentRound;
            document.getElementById('totalLaps').textContent = gameState.totalLaps;
        }

        // =========== ATUALIZAR INFORMA√á√ïES DO JOGADOR ===========
        function updateCurrentPlayerInfo() {
            const player = gameState.players[gameState.currentPlayer];
            const infoBar = document.getElementById('currentPlayerInfo');
            
            // Calcular d√≠vida total e juros POR VOLTA
            let totalDebt = 0;
            let lapInterest = 0; // Juros por volta
            
            player.loans.forEach(loan => {
                totalDebt += loan.amount;
                lapInterest += loan.amount * 0.1; // 10% por VOLTA
            });
            
            let html = `
                <div class="player-info-item">
                    <div class="info-label">JOGADOR ATUAL</div>
                    <div class="info-value" style="color: var(--player${player.id})">
                        ${player.name}
                    </div>
                </div>
                
                <div class="player-info-item">
                    <div class="info-label">PROFISS√ÉO</div>
                    <div class="info-value">${player.profession}</div>
                </div>
                
                <div class="player-info-item">
                    <div class="info-label">DINHEIRO</div>
                    <div class="info-value info-income">R$ ${player.cash.toLocaleString()}</div>
                </div>
                
                <div class="player-info-item">
                    <div class="info-label">RENDA PASSIVA</div>
                    <div class="info-value info-income">R$ ${player.passiveIncome.toLocaleString()}/m√™s</div>
                </div>
                
                <div class="player-info-item">
                    <div class="info-label">DESPESAS</div>
                    <div class="info-value info-expense">R$ ${player.expenses.toLocaleString()}/m√™s</div>
                </div>
                
                <div class="player-info-item">
                    <div class="info-label">VOLTAS</div>
                    <div class="info-value">${player.lapsCompleted}</div>
                </div>
            `;
            
            if (player.inRatRace) {
                html += `
                    <div class="player-info-item">
                        <div class="info-label">STATUS</div>
                        <div class="info-value info-warning">CORRIDA DOS RATOS</div>
                    </div>
                `;
            } else {
                html += `
                    <div class="player-info-item">
                        <div class="info-label">STATUS</div>
                        <div class="info-value" style="color: #f39c12;">VIA R√ÅPIDA üöÄ</div>
                    </div>
                `;
            }
            
            if (totalDebt > 0) {
                html += `
                    <div class="debt-indicator pulse-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>D√çVIDA: R$ ${totalDebt.toLocaleString()} (Juros por volta: R$ ${lapInterest.toLocaleString()})</span>
                    </div>
                `;
            }
            
            infoBar.innerHTML = html;
        }

        // =========== SISTEMA DE DADOS ===========
        function rollDice() {
            if (!gameState.gameActive) {
                alert("O jogo n√£o est√° ativo!");
                return;
            }
            
            const player = gameState.players[gameState.currentPlayer];
            
            // Se o jogador est√° na via r√°pida, n√£o pode rolar dados
            if (!player.inRatRace) {
                addLog(`üöÄ ${player.name} est√° na Via R√°pida e n√£o rola dados. Esperando sonho...`);
                document.getElementById('endTurnBtn').disabled = false;
                return;
            }
            
            const rollBtn = document.getElementById('rollDiceBtn');
            rollBtn.disabled = true;
            
            const dice1 = document.getElementById('dice1');
            const dice2 = document.getElementById('dice2');
            const dice3 = document.createElement('div');
            
            dice1.classList.add('rolling');
            dice2.classList.add('rolling');
            
            if (gameState.dice3Enabled && gameState.charityPlayer === gameState.currentPlayer) {
                dice3.className = 'dice rolling';
                dice3.textContent = '?';
                dice3.id = 'dice3';
                document.querySelector('.dice-container').appendChild(dice3);
            }
            
            setTimeout(() => {
                const dice1Value = Math.floor(Math.random() * 6) + 1;
                const dice2Value = Math.floor(Math.random() * 6) + 1;
                
                let total = dice1Value + dice2Value;
                let diceValues = [dice1Value, dice2Value];
                
                if (gameState.dice3Enabled && gameState.charityPlayer === gameState.currentPlayer) {
                    const dice3Value = Math.floor(Math.random() * 6) + 1;
                    diceValues.push(dice3Value);
                    diceValues.sort((a, b) => b - a);
                    total = diceValues[0] + diceValues[1];
                    
                    dice3.textContent = dice3Value;
                    dice3.classList.remove('rolling');
                    addLog(`üé≤ B√¥nus de caridade! Dados: ${dice1Value}, ${dice2Value}, ${dice3Value} ‚Üí usando ${diceValues[0]} e ${diceValues[1]}`);
                    
                    gameState.dice3Enabled = false;
                    gameState.charityPlayer = null;
                } else {
                    addLog(`üé≤ ${player.name} rolou ${dice1Value}+${dice2Value}=${total}`);
                }
                
                gameState.diceValue = total;
                
                dice1.textContent = dice1Value;
                dice2.textContent = dice2Value;
                dice1.classList.remove('rolling');
                dice2.classList.remove('rolling');
                
                movePlayer(gameState.currentPlayer, total);
                
                document.getElementById('endTurnBtn').disabled = false;
                
            }, 800);
        }

        function movePlayer(playerId, steps) {
            const player = gameState.players[playerId];
            
            // Se o jogador est√° na via r√°pida, n√£o se move no tabuleiro normal
            if (!player.inRatRace) {
                addLog(`üöÄ ${player.name} est√° na Via R√°pida e n√£o se move no tabuleiro normal`);
                updateFastTrack();
                document.getElementById('endTurnBtn').disabled = false;
                return;
            }
            
            const oldPosition = player.position;
            let newPosition = (player.position + steps) % 40;
            
            // Verifica se completou uma volta
            if (newPosition < oldPosition && steps > 0) {
                player.lapsCompleted++;
                gameState.totalLaps = Math.max(gameState.totalLaps, player.lapsCompleted);
                
                // Aplica juros dos empr√©stimos a cada volta
                applyLoanInterest(playerId);
                
                // Recebe pagamento
                payday(playerId);
                
                addLog(`üîÑ ${player.name} completou uma volta! Total: ${player.lapsCompleted} volta(s)`);
            }
            
            player.position = newPosition;
            updateBoard();
            updateCurrentPlayerInfo();
            updateGameStats();
            activateSpace(playerId, newPosition);
        }

        // =========== APLICAR JUROS POR VOLTA ===========
        function applyLoanInterest(playerId) {
            const player = gameState.players[playerId];
            
            if (player.loans.length === 0) return;
            
            let totalInterest = 0;
            
            player.loans.forEach(loan => {
                const interest = loan.amount * 0.1; // 10% por volta
                totalInterest += interest;
            });
            
            // Os juros s√£o adicionados √†s despesas mensais
            player.expenses += totalInterest;
            player.cashflow = player.salary + player.passiveIncome - player.expenses;
            
            if (totalInterest > 0) {
                addLog(`üè¶ ${player.name} pagou juros de R$ ${totalInterest.toLocaleString()} nesta volta`);
            }
        }

        // =========== ATIVA√á√ÉO DE ESPA√áOS ===========
        function activateSpace(playerId, position) {
            const player = gameState.players[playerId];
            const space = gameState.spaces[position];
            
            document.getElementById('cardDisplay').style.display = 'none';
            
            addLog(`üìç ${player.name} est√° no espa√ßo ${position}: ${space.name}`);
            
            setTimeout(() => {
                switch(space.type) {
                    case 'payday':
                        payday(playerId);
                        break;
                    case 'baby':
                        haveBaby(playerId);
                        break;
                    case 'charity':
                        charity(playerId);
                        break;
                    case 'small':
                        showCard('small', playerId);
                        break;
                    case 'big':
                        showCard('big', playerId);
                        break;
                    case 'doodad':
                        showDoodadCard(playerId);
                        break;
                    case 'market':
                        showCard('market', playerId);
                        break;
                    case 'dream':
                        if (!player.inRatRace) {
                            showDream(playerId);
                        }
                        break;
                }
            }, 500);
        }

        // =========== SISTEMA DE CARTAS ===========
        function getRandomCard(type) {
            const cards = {
                small: [
                    { name: "A√ß√µes TechBR", type: "a√ß√£o", cost: 5000, downPayment: 500, cashflow: 100, description: "Startup de tecnologia em crescimento" },
                    { name: "FII Shopping", type: "fii", cost: 6000, downPayment: 600, cashflow: 120, description: "Fundos Imobili√°rios de shopping centers" },
                    { name: "Tesouro Direto", type: "t√≠tulo", cost: 3000, downPayment: 300, cashflow: 50, description: "T√≠tulos p√∫blicos federais" },
                    { name: "A√ß√µes Minera√ß√£o", type: "a√ß√£o", cost: 8000, downPayment: 800, cashflow: 150, description: "Empresa de minera√ß√£o com novas reservas" }
                ],
                big: [
                    { name: "Apartamento Centro", type: "im√≥vel", cost: 150000, downPayment: 15000, cashflow: 800, description: "2 quartos em bairro consolidado" },
                    { name: "Franquia Lanches", type: "neg√≥cio", cost: 200000, downPayment: 50000, cashflow: 3000, description: "Marca conhecida em local movimentado" },
                    { name: "Casa Condom√≠nio", type: "im√≥vel", cost: 250000, downPayment: 25000, cashflow: 1200, description: "3 quartos em √°rea nobre" },
                    { name: "Loja Shopping", type: "neg√≥cio", cost: 120000, downPayment: 30000, cashflow: 2000, description: "Em shopping center consolidado" }
                ],
                market: [
                    { name: "BOLSA EM ALTA!", type: "alta", effect: "a√ß√µes", modifier: 1.5, description: "√çndice subiu 15% - √≥timo momento para vender a√ß√µes!" },
                    { name: "IM√ìVEIS VALORIZADOS", type: "alta", effect: "im√≥vel", modifier: 1.3, description: "Demanda por im√≥veis aumentou - venda com lucro!" },
                    { name: "BOLSA EM QUEDA", type: "baixa", effect: "a√ß√µes", modifier: 0.7, description: "Crise pol√≠tica afetou o mercado de a√ß√µes" },
                    { name: "CRISE IMOBILI√ÅRIA", type: "baixa", effect: "im√≥vel", modifier: 0.75, description: "Juros altos esfriaram o mercado imobili√°rio" },
                    { name: "OPORTUNIDADE ESPECIAL", type: "oportunidade", effect: "a√ß√µes", modifier: 0.6, description: "A√ß√µes descontadas - compre agora com 40% OFF!" }
                ]
            };
            
            const cardList = cards[type];
            return cardList[Math.floor(Math.random() * cardList.length)];
        }

        function showCard(type, playerId) {
            const card = getRandomCard(type);
            gameState.currentCard = { ...card, playerId: playerId, cardType: type };
            
            const display = document.getElementById('cardDisplay');
            const title = document.getElementById('cardTitle');
            const description = document.getElementById('cardDescription');
            const details = document.getElementById('cardDetails');
            const actions = document.getElementById('cardActions');
            
            if (type === 'small') {
                title.textContent = 'PEQUENA OPORTUNIDADE';
                description.textContent = card.description;
                
                details.innerHTML = `
                    <div class="card-detail">
                        <div class="detail-label">Nome</div>
                        <div class="detail-value">${card.name}</div>
                    </div>
                    <div class="card-detail">
                        <div class="detail-label">Tipo</div>
                        <div class="detail-value">${card.type}</div>
                    </div>
                    <div class="card-detail">
                        <div class="detail-label">Custo</div>
                        <div class="detail-value">R$ ${card.cost.toLocaleString()}</div>
                    </div>
                    <div class="card-detail">
                        <div class="detail-label">Entrada</div>
                        <div class="detail-value">R$ ${card.downPayment.toLocaleString()}</div>
                    </div>
                    <div class="card-detail">
                        <div class="detail-label">Renda Mensal</div>
                        <div class="detail-value" style="color: #2ecc71;">+R$ ${card.cashflow}</div>
                    </div>
                `;
                
                actions.innerHTML = `
                    <button class="button button-success" onclick="buyAsset()">
                        <i class="fas fa-check"></i> COMPRAR
                    </button>
                    <button class="button" onclick="declineCard()">
                        <i class="fas fa-times"></i> RECUSAR
                    </button>
                `;
                
            } else if (type === 'big') {
                title.textContent = 'GRANDE OPORTUNIDADE';
                description.textContent = card.description;
                
                details.innerHTML = `
                    <div class="card-detail">
                        <div class="detail-label">Nome</div>
                        <div class="detail-value">${card.name}</div>
                    </div>
                    <div class="card-detail">
                        <div class="detail-label">Tipo</div>
                        <div class="detail-value">${card.type}</div>
                    </div>
                    <div class="card-detail">
                        <div class="detail-label">Custo Total</div>
                        <div class="detail-value">R$ ${card.cost.toLocaleString()}</div>
                    </div>
                    <div class="card-detail">
                        <div class="detail-label">Entrada</div>
                        <div class="detail-value">R$ ${card.downPayment.toLocaleString()}</div>
                    </div>
                    <div class="card-detail">
                        <div class="detail-label">Renda Mensal</div>
                        <div class="detail-value" style="color: #2ecc71;">+R$ ${card.cashflow}</div>
                    </div>
                `;
                
                actions.innerHTML = `
                    <button class="button button-success" onclick="buyAsset()">
                        <i class="fas fa-check"></i> COMPRAR
                    </button>
                    <button class="button" onclick="declineCard()">
                        <i class="fas fa-times"></i> RECUSAR
                    </button>
                `;
                
            } else if (type === 'market') {
                title.textContent = 'MERCADO';
                description.textContent = card.description;
                
                const isHighMarket = card.type === 'alta' || card.type === 'oportunidade';
                
                details.innerHTML = `
                    <div class="card-detail">
                        <div class="detail-label">Evento</div>
                        <div class="detail-value">${card.name}</div>
                    </div>
                    <div class="card-detail">
                        <div class="detail-label">Afeta</div>
                        <div class="detail-value">${card.effect === 'a√ß√µes' ? 'A√á√ïES' : 'IM√ìVEIS'}</div>
                    </div>
                    <div class="card-detail">
                        <div class="detail-label">Varia√ß√£o</div>
                        <div class="detail-value" style="color: ${card.modifier > 1 ? '#2ecc71' : '#e74c3c'}">
                            ${card.modifier > 1 ? '+' : ''}${((card.modifier - 1) * 100).toFixed(0)}%
                        </div>
                    </div>
                `;
                
                if (isHighMarket) {
                    actions.innerHTML = `
                        <button class="button button-success" onclick="marketAction(true)">
                            <i class="fas fa-check"></i> VENDER ATIVOS
                        </button>
                        <button class="button" onclick="marketAction(false)">
                            <i class="fas fa-times"></i> MANTER ATIVOS
                        </button>
                    `;
                } else {
                    actions.innerHTML = `
                        <button class="button" onclick="declineCard()">
                            <i class="fas fa-check"></i> ENTENDI (APENAS INFORMA√á√ÉO)
                        </button>
                    `;
                }
            }
            
            display.style.display = 'block';
            display.scrollIntoView({ behavior: 'smooth' });
        }

        // =========== DOODADS POR FASE ===========
        function showDoodadCard(playerId) {
            const doodads = doodadsByPhase[gameState.gamePhase];
            const card = doodads[Math.floor(Math.random() * doodads.length)];
            
            gameState.currentCard = { 
                ...card, 
                playerId: playerId, 
                cardType: 'doodad',
                phase: gameState.gamePhase 
            };
            
            const display = document.getElementById('cardDisplay');
            const title = document.getElementById('cardTitle');
            const phaseTag = document.getElementById('cardPhaseTag');
            const description = document.getElementById('cardDescription');
            const details = document.getElementById('cardDetails');
            const actions = document.getElementById('cardActions');
            
            // Configura√ß√£o baseada na fase
            let phaseText = "";
            let phaseColor = "";
            
            switch(gameState.gamePhase) {
                case 1:
                    phaseText = "FASE 1 - IN√çCIO";
                    phaseColor = "#2ecc71";
                    break;
                case 2:
                    phaseText = "FASE 2 - MEIO DO JOGO";
                    phaseColor = "#f39c12";
                    break;
                case 3:
                    phaseText = "FASE 3 - AVAN√áADO";
                    phaseColor = "#e74c3c";
                    break;
            }
            
            title.textContent = 'DOODAD - GASTO OBRIGAT√ìRIO';
            phaseTag.textContent = phaseText;
            phaseTag.style.backgroundColor = phaseColor;
            description.textContent = `‚ö†Ô∏è ${card.description} - Este gasto √© OBRIGAT√ìRIO!`;
            
            details.innerHTML = `
                <div class="card-detail">
                    <div class="detail-label">Item</div>
                    <div class="detail-value">${card.name}</div>
                </div>
                <div class="card-detail">
                    <div class="detail-label">Fase</div>
                    <div class="detail-value">${phaseText}</div>
                </div>
                <div class="card-detail">
                    <div class="detail-label">Custo</div>
                    <div class="detail-value" style="color: #e74c3c;">R$ ${card.cost.toLocaleString()}</div>
                </div>
                ${card.monthly > 0 ? `
                <div class="card-detail">
                    <div class="detail-label">Despesa Mensal</div>
                    <div class="detail-value" style="color: #e74c3c;">R$ ${card.monthly}/m√™s</div>
                </div>
                ` : ''}
            `;
            
            actions.innerHTML = `
                <button class="button button-danger" onclick="payDoodad()">
                    <i class="fas fa-check"></i> PAGAR (OBRIGAT√ìRIO)
                </button>
            `;
            
            display.style.display = 'block';
            display.scrollIntoView({ behavior: 'smooth' });
        }

        // =========== SISTEMA DE EMPR√âSTIMOS ===========
        function takeLoan(playerId, amount) {
            const player = gameState.players[playerId];
            const loanAmount = Math.max(1000, Math.ceil(amount / 1000) * 1000);
            
            player.loans.push({
                amount: loanAmount,
                interestRate: 0.1, // 10% por volta
                takenAt: Date.now()
            });
            
            player.cash += loanAmount;
            
            // Os juros ser√£o aplicados a cada volta, n√£o imediatamente
            addLog(`üè¶ ${player.name} pegou empr√©stimo de R$ ${loanAmount.toLocaleString()} (juros: 10% por volta)`);
            
            updateCurrentPlayerInfo();
            return loanAmount;
        }

        // =========== PAGAR DOODAD ===========
        function payDoodad() {
            const card = gameState.currentCard;
            const player = gameState.players[card.playerId];
            
            if (player.cash >= card.cost) {
                player.cash -= card.cost;
                
                if (card.monthly > 0) {
                    player.expenses += card.monthly;
                    player.cashflow = player.salary + player.passiveIncome - player.expenses;
                    player.liabilities.push({
                        name: card.name,
                        monthly: card.monthly,
                        phase: card.phase
                    });
                }
                
                addLog(`üí∏ ${player.name} pagou R$ ${card.cost.toLocaleString()} por ${card.name} (Fase ${card.phase})`);
                
            } else {
                const shortage = card.cost - player.cash;
                const loanAmount = takeLoan(card.playerId, shortage);
                
                player.cash += loanAmount;
                player.cash -= card.cost;
                
                if (card.monthly > 0) {
                    player.expenses += card.monthly;
                    player.cashflow = player.salary + player.passiveIncome - player.expenses;
                    player.liabilities.push({
                        name: card.name,
                        monthly: card.monthly,
                        phase: card.phase
                    });
                }
                
                addLog(`üí∏ ${player.name} pagou ${card.name} com empr√©stimo de R$ ${loanAmount.toLocaleString()}`);
            }
            
            checkExitRatRace(card.playerId);
            document.getElementById('cardDisplay').style.display = 'none';
            updateCurrentPlayerInfo();
        }

        // =========== COMPRAR ATIVOS ===========
        function buyAsset() {
            const card = gameState.currentCard;
            const player = gameState.players[card.playerId];
            
            if (player.cash < card.downPayment) {
                const shortage = card.downPayment - player.cash;
                const neededLoan = Math.max(1000, Math.ceil(shortage / 1000) * 1000);
                
                if (confirm(`Dinheiro insuficiente! Voc√™ tem R$ ${player.cash.toLocaleString()}, precisa de R$ ${card.downPayment.toLocaleString()}.\n\nPegar empr√©stimo de R$ ${neededLoan.toLocaleString()}? (Juros: 10% por volta)`)) {
                    const loanAmount = takeLoan(card.playerId, shortage);
                    player.cash += loanAmount;
                    
                    player.cash -= card.downPayment;
                    player.passiveIncome += card.cashflow;
                    player.cashflow = player.salary + player.passiveIncome - player.expenses;
                    
                    player.assets.push({
                        name: card.name,
                        type: card.cardType === 'small' ? 'pequeno' : 'grande',
                        value: card.downPayment,
                        cashflow: card.cashflow,
                        originalCost: card.cost
                    });
                    
                    addLog(`‚úÖ ${player.name} comprou ${card.name} com empr√©stimo de R$ ${loanAmount.toLocaleString()} (renda: +R$ ${card.cashflow}/m√™s)`);
                } else {
                    addLog(`‚ùå ${player.name} desistiu de comprar ${card.name} por falta de dinheiro`);
                    document.getElementById('cardDisplay').style.display = 'none';
                    return;
                }
            } else {
                player.cash -= card.downPayment;
                player.passiveIncome += card.cashflow;
                player.cashflow = player.salary + player.passiveIncome - player.expenses;
                
                player.assets.push({
                    name: card.name,
                    type: card.cardType === 'small' ? 'pequeno' : 'grande',
                    value: card.downPayment,
                    cashflow: card.cashflow,
                    originalCost: card.cost
                });
                
                addLog(`‚úÖ ${player.name} comprou ${card.name} por R$ ${card.downPayment.toLocaleString()} (renda: +R$ ${card.cashflow}/m√™s)`);
            }
            
            checkExitRatRace(card.playerId);
            document.getElementById('cardDisplay').style.display = 'none';
            updateCurrentPlayerInfo();
        }

        function marketAction(sell) {
            const card = gameState.currentCard;
            const player = gameState.players[card.playerId];
            
            if (sell) {
                const assetsToSell = player.assets.filter(asset => {
                    return (card.effect === 'a√ß√µes' && asset.type === 'pequeno') ||
                           (card.effect === 'im√≥vel' && asset.type === 'grande');
                });
                
                if (assetsToSell.length > 0) {
                    const asset = assetsToSell[0];
                    const saleValue = Math.round(asset.value * card.modifier);
                    
                    const index = player.assets.indexOf(asset);
                    player.assets.splice(index, 1);
                    player.passiveIncome -= asset.cashflow;
                    player.cashflow = player.salary + player.passiveIncome - player.expenses;
                    player.cash += saleValue;
                    
                    addLog(`üí∞ ${player.name} vendeu ${asset.name} por R$ ${saleValue.toLocaleString()}`);
                } else {
                    addLog(`üìä ${player.name} n√£o tem ativos para vender`);
                }
            } else {
                addLog(`üìä ${player.name} optou por manter os ativos`);
            }
            
            document.getElementById('cardDisplay').style.display = 'none';
        }

        function declineCard() {
            const player = gameState.players[gameState.currentCard.playerId];
            addLog(`‚ùå ${player.name} recusou a oferta`);
            document.getElementById('cardDisplay').style.display = 'none';
        }

        // =========== EVENTOS DO TABULEIRO ===========
        function payday(playerId) {
            const player = gameState.players[playerId];
            const total = player.salary + player.passiveIncome;
            player.cash += total;
            
            addLog(`üí∞ ${player.name} recebeu R$ ${total.toLocaleString()} (sal√°rio + renda passiva)`);
            updateCurrentPlayerInfo();
        }

        function haveBaby(playerId) {
            const player = gameState.players[playerId];
            const cost = 300;
            
            player.expenses += cost;
            player.cashflow = player.salary + player.passiveIncome - player.expenses;
            
            addLog(`üë∂ ${player.name} teve um beb√™! Despesas +R$ ${cost}/m√™s`);
            updateCurrentPlayerInfo();
        }

        function charity(playerId) {
            const player = gameState.players[playerId];
            const amount = Math.floor(player.salary * 0.1);
            
            if (player.cash >= amount) {
                player.cash -= amount;
                addLog(`‚ù§Ô∏è ${player.name} doou R$ ${amount.toLocaleString()} para caridade`);
                
                gameState.dice3Enabled = true;
                gameState.charityPlayer = playerId;
                addLog(`üé≤ Pr√≥ximo turno, ${player.name} pode rolar 3 dados e usar os 2 maiores!`);
            } else {
                const loanAmount = takeLoan(playerId, amount);
                player.cash += loanAmount;
                player.cash -= amount;
                
                addLog(`‚ù§Ô∏è ${player.name} doou R$ ${amount.toLocaleString()} com empr√©stimo`);
                
                gameState.dice3Enabled = true;
                gameState.charityPlayer = playerId;
                addLog(`üé≤ Pr√≥ximo turno, ${player.name} pode rolar 3 dados e usar os 2 maiores!`);
            }
            
            updateCurrentPlayerInfo();
        }

        // =========== QUITAR D√çVIDAS ===========
        function showDebtModal() {
            const player = gameState.players[gameState.currentPlayer];
            let totalDebt = 0;
            let lapInterest = 0; // Juros por volta
            
            player.loans.forEach(loan => {
                totalDebt += loan.amount;
                lapInterest += loan.amount * 0.1;
            });
            
            let html = `
                <div style="margin-bottom: 20px;">
                    <h3 style="color: var(--dark); margin-bottom: 10px;">Situa√ß√£o Financeira</h3>
                    <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span style="color: #666;">Dinheiro Dispon√≠vel:</span>
                            <span style="font-weight: bold; color: var(--dark);">R$ ${player.cash.toLocaleString()}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span style="color: #666;">D√≠vida Total:</span>
                            <span style="font-weight: bold; color: #e74c3c;">R$ ${totalDebt.toLocaleString()}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span style="color: #666;">Juros por Volta:</span>
                            <span style="font-weight: bold; color: #e74c3c;">R$ ${lapInterest.toLocaleString()}/volta</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span style="color: #666;">Voltas Completas:</span>
                            <span style="font-weight: bold; color: var(--dark);">${player.lapsCompleted}</span>
                        </div>
                    </div>
                </div>
            `;
            
            if (totalDebt === 0) {
                html += `
                    <div style="text-align: center; padding: 20px;">
                        <i class="fas fa-check-circle" style="font-size: 3rem; color: #2ecc71;"></i>
                        <h3 style="color: #2ecc71; margin: 10px 0;">Sem d√≠vidas!</h3>
                        <p>Voc√™ n√£o tem empr√©stimos para quitar.</p>
                    </div>
                `;
            } else {
                html += `
                    <h3 style="color: var(--dark); margin-bottom: 15px;">Seus Empr√©stimos:</h3>
                `;
                
                player.loans.forEach((loan, index) => {
                    const lapPayment = loan.amount * 0.1;
                    const canPayFull = player.cash >= loan.amount;
                    
                    html += `
                        <div style="background: ${index % 2 === 0 ? '#f8f9fa' : '#e9ecef'}; 
                                    padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong>Empr√©stimo #${index + 1}</strong><br>
                                    <small>Valor: R$ ${loan.amount.toLocaleString()}</small><br>
                                    <small style="color: #e74c3c;">Juros por volta: R$ ${lapPayment.toLocaleString()}</small>
                                </div>
                                <div>
                                    ${canPayFull ? 
                                        `<button class="button button-success" onclick="payLoan(${index}, ${loan.amount})" style="padding: 8px 15px;">
                                            <i class="fas fa-check"></i> Quitar
                                        </button>` : 
                                        `<button class="button" onclick="payLoan(${index}, ${player.cash})" style="padding: 8px 15px;">
                                            <i class="fas fa-check"></i> Pagar R$ ${player.cash.toLocaleString()}
                                        </button>`
                                    }
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += `
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="button button-danger" onclick="payAllLoans()" style="padding: 12px 30px;">
                            <i class="fas fa-money-bill-wave"></i> QUITAR TODAS AS D√çVIDAS
                        </button>
                        <p style="margin-top: 10px; color: #666; font-size: 0.9rem;">
                            <i class="fas fa-info-circle"></i> Quitar d√≠vidas remove os juros que seriam cobrados nas pr√≥ximas voltas!
                        </p>
                    </div>
                `;
            }
            
            document.getElementById('debtContent').innerHTML = html;
            document.getElementById('debtModal').style.display = 'flex';
        }

        function payLoan(loanIndex, amount) {
            const player = gameState.players[gameState.currentPlayer];
            const loan = player.loans[loanIndex];
            
            if (amount > player.cash) {
                alert(`Voc√™ s√≥ tem R$ ${player.cash.toLocaleString()} dispon√≠vel!`);
                return;
            }
            
            if (amount >= loan.amount) {
                // Remove juros que seriam cobrados
                const interestSaved = loan.amount * 0.1;
                // N√£o remove das despesas porque juros s√£o cobrados por volta, n√£o mensalmente
                
                player.cash -= loan.amount;
                player.loans.splice(loanIndex, 1);
                
                addLog(`üí≥ ${player.name} quitou empr√©stimo de R$ ${loan.amount.toLocaleString()} (evitou juros de R$ ${interestSaved.toLocaleString()}/volta)`);
            } else {
                loan.amount -= amount;
                player.cash -= amount;
                
                addLog(`üí≥ ${player.name} pagou R$ ${amount.toLocaleString()} do empr√©stimo`);
            }
            
            updateCurrentPlayerInfo();
            showDebtModal();
        }

        function payAllLoans() {
            const player = gameState.players[gameState.currentPlayer];
            let totalDebt = 0;
            let totalInterestSaved = 0;
            
            player.loans.forEach(loan => {
                totalDebt += loan.amount;
                totalInterestSaved += loan.amount * 0.1;
            });
            
            if (player.cash < totalDebt) {
                alert(`Dinheiro insuficiente! Voc√™ tem R$ ${player.cash.toLocaleString()}, precisa de R$ ${totalDebt.toLocaleString()}`);
                return;
            }
            
            player.cash -= totalDebt;
            player.loans = [];
            
            addLog(`üí≥ ${player.name} quitou TODAS as d√≠vidas! Total: R$ ${totalDebt.toLocaleString()} (evitou juros de R$ ${totalInterestSaved.toLocaleString()}/volta)`);
            
            closeModal('debtModal');
            updateCurrentPlayerInfo();
        }

        // =========== SAIR DA CORRIDA DOS RATOS ===========
        function checkExitRatRace(playerId) {
            const player = gameState.players[playerId];
            
            if (player.passiveIncome > player.expenses && player.inRatRace) {
                player.inRatRace = false;
                player.position = 39;
                
                // B√¥nus para entrar na via r√°pida
                player.cash += 100000;
                
                updateBoard();
                updateFastTrack(); // Atualiza a tabela da via r√°pida
                
                addLog(`üöÄüéâ ${player.name} SAIU DA CORRIDA DOS RATOS!`);
                addLog(`üí∞ B√¥nus de entrada na Via R√°pida: R$ 100.000`);
                addLog(`üí∞ ${player.name} vive apenas de renda passiva: R$ ${player.passiveIncome}/m√™s`);
            }
        }

        // =========== VIA R√ÅPIDA ===========
        function showDream(playerId) {
            const player = gameState.players[playerId];
            const dreams = [
                { name: "üèùÔ∏è Viagem ao Caribe", cost: 15000, passiveRequired: 5000, description: "2 semanas em resort 5 estrelas" },
                { name: "üöó Carro Esportivo", cost: 200000, passiveRequired: 10000, description: "Modelo importado de luxo" },
                { name: "üè† Casa na Praia", cost: 500000, passiveRequired: 20000, description: "Casa com piscina e vista para o mar" }
            ];
            
            const dream = dreams[Math.floor(Math.random() * dreams.length)];
            gameState.currentCard = { ...dream, playerId: playerId, cardType: 'dream' };
            
            const display = document.getElementById('cardDisplay');
            const title = document.getElementById('cardTitle');
            const description = document.getElementById('cardDescription');
            const details = document.getElementById('cardDetails');
            const actions = document.getElementById('cardActions');
            
            title.textContent = 'SONHO DA VIA R√ÅPIDA';
            description.textContent = dream.description;
            
            const canBuy = player.passiveIncome >= dream.passiveRequired && player.cash >= dream.cost;
            
            details.innerHTML = `
                <div class="card-detail">
                    <div class="detail-label">Sonho</div>
                    <div class="detail-value">${dream.name}</div>
                </div>
                <div class="card-detail">
                    <div class="detail-label">Custo</div>
                    <div class="detail-value">R$ ${dream.cost.toLocaleString()}</div>
                </div>
                <div class="card-detail">
                    <div class="detail-label">Renda Passiva Necess√°ria</div>
                    <div class="detail-value">R$ ${dream.passiveRequired.toLocaleString()}/m√™s</div>
                </div>
                <div class="card-detail">
                    <div class="detail-label">Sua Renda Passiva</div>
                    <div class="detail-value" style="color: ${canBuy ? '#2ecc71' : '#e74c3c'}">
                        R$ ${player.passiveIncome.toLocaleString()}/m√™s
                    </div>
                </div>
            `;
            
            if (canBuy) {
                actions.innerHTML = `
                    <button class="button button-success" onclick="buyDream()">
                        <i class="fas fa-trophy"></i> REALIZAR SONHO!
                    </button>
                    <button class="button" onclick="declineCard()">
                        <i class="fas fa-times"></i> ESPERAR
                    </button>
                `;
            } else {
                actions.innerHTML = `
                    <button class="button" onclick="declineCard()">
                        <i class="fas fa-check"></i> CONTINUAR
                    </button>
                `;
            }
            
            display.style.display = 'block';
        }

        function buyDream() {
            const card = gameState.currentCard;
            const player = gameState.players[card.playerId];
            
            if (player.cash < card.cost) {
                alert(`Dinheiro insuficiente! Necess√°rio: R$ ${card.cost.toLocaleString()}`);
                return;
            }
            
            player.cash -= card.cost;
            player.dreams.push(card.name);
            
            addLog(`üèÜ ${player.name} REALIZOU O SONHO: ${card.name}!`);
            
            if (player.dreams.length >= 1) {
                declareWinner(card.playerId);
            }
            
            document.getElementById('cardDisplay').style.display = 'none';
            updateCurrentPlayerInfo();
        }

        function declareWinner(playerId) {
            const player = gameState.players[playerId];
            gameState.gameActive = false;
            
            const winnerDiv = document.getElementById('winnerMessage');
            winnerDiv.innerHTML = `
                <div style="background: linear-gradient(135deg, #f39c12, #e67e22); 
                           color: white; padding: 15px; border-radius: 10px; 
                           text-align: center; margin-top: 15px; font-weight: bold;">
                    üèÜüéâ ${player.name} VENCEU O JOGO! üéâüèÜ<br>
                    <small>Realizou o sonho: ${player.dreams[player.dreams.length-1]}</small>
                </div>
            `;
            
            addLog(`üèÜüéâ ${player.name} VENCEU O JOGO! PARAB√âNS!`);
            
            document.getElementById('rollDiceBtn').disabled = true;
            document.getElementById('endTurnBtn').disabled = true;
        }

        // =========== TURNO ===========
        function endTurn() {
            gameState.currentPlayer = gameState.currentPlayer % gameState.totalPlayers + 1;
            
            // Se voltou ao jogador 1, incrementa rodada
            if (gameState.currentPlayer === 1) {
                gameState.currentRound++;
                addLog(`üìÖ RODADA ${gameState.currentRound} INICIADA`);
                updateGameStats();
            }
            
            document.getElementById('endTurnBtn').disabled = true;
            document.getElementById('rollDiceBtn').disabled = false;
            
            document.getElementById('cardDisplay').style.display = 'none';
            
            updateCurrentPlayerInfo();
            
            const playerName = gameState.players[gameState.currentPlayer].name;
            addLog(`üîÑ Vez de: ${playerName}`);
        }

        // =========== ATIVOS ===========
        function showAssets() {
            const player = gameState.players[gameState.currentPlayer];
            let html = `<h3 style="color: var(--secondary); margin-bottom: 15px;">${player.name} - ${player.profession}</h3>`;
            
            // Estat√≠sticas
            html += `
                <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <div>
                            <div style="color: #666; font-size: 0.9rem;">Sal√°rio</div>
                            <div style="font-weight: bold;">R$ ${player.salary.toLocaleString()}/m√™s</div>
                        </div>
                        <div>
                            <div style="color: #666; font-size: 0.9rem;">Despesas</div>
                            <div style="font-weight: bold; color: #e74c3c;">R$ ${player.expenses.toLocaleString()}/m√™s</div>
                        </div>
                        <div>
                            <div style="color: #666; font-size: 0.9rem;">Renda Passiva</div>
                            <div style="font-weight: bold; color: #2ecc71;">R$ ${player.passiveIncome.toLocaleString()}/m√™s</div>
                        </div>
                        <div>
                            <div style="color: #666; font-size: 0.9rem;">Fluxo de Caixa</div>
                            <div style="font-weight: bold; color: ${player.cashflow >= 0 ? '#2ecc71' : '#e74c3c'}">
                                R$ ${player.cashflow.toLocaleString()}/m√™s
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Ativos
            html += `<h4 style="color: #2ecc71; margin-top: 15px; border-bottom: 2px solid #2ecc71; padding-bottom: 5px;">ATIVOS (Renda Passiva: R$ ${player.passiveIncome}/m√™s)</h4>`;
            if (player.assets.length === 0) {
                html += '<p>Nenhum ativo adquirido.</p>';
            } else {
                player.assets.forEach(asset => {
                    html += `
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <div><strong>${asset.name}</strong></div>
                            <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                                <span>Tipo: ${asset.type.toUpperCase()}</span>
                                <span>Valor: R$ ${asset.value.toLocaleString()}</span>
                                <span style="color: #2ecc71;">Renda: +R$ ${asset.cashflow}/m√™s</span>
                            </div>
                        </div>
                    `;
                });
            }
            
            // Passivos (doodads)
            html += `<h4 style="color: #e74c3c; margin-top: 20px; border-bottom: 2px solid #e74c3c; padding-bottom: 5px;">PASSIVOS</h4>`;
            if (player.liabilities.length === 0) {
                html += '<p>Nenhum passivo.</p>';
            } else {
                player.liabilities.forEach(liability => {
                    html += `
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <div><strong>${liability.name}</strong></div>
                            <div style="color: #e74c3c;">Despesa: R$ ${liability.monthly}/m√™s</div>
                            <div style="color: #666; font-size: 0.8rem;">Fase: ${liability.phase}</div>
                        </div>
                    `;
                });
            }
            
            // Empr√©stimos
            html += `<h4 style="color: #9b59b6; margin-top: 20px; border-bottom: 2px solid #9b59b6; padding-bottom: 5px;">EMPR√âSTIMOS</h4>`;
            if (player.loans.length === 0) {
                html += '<p>Nenhum empr√©stimo.</p>';
            } else {
                let totalDebt = 0;
                let totalInterest = 0;
                
                player.loans.forEach((loan, index) => {
                    totalDebt += loan.amount;
                    totalInterest += loan.amount * 0.1;
                    html += `
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <div><strong>Empr√©stimo #${index + 1}</strong></div>
                            <div>Valor: R$ ${loan.amount.toLocaleString()}</div>
                            <div style="color: #e74c3c;">Juros por volta: R$ ${(loan.amount * 0.1).toLocaleString()}</div>
                        </div>
                    `;
                });
                
                html += `<div style="background: #e74c3c20; padding: 10px; border-radius: 8px; margin-top: 10px;">
                    <strong>Total:</strong> D√≠vida: R$ ${totalDebt.toLocaleString()} | Juros por volta: R$ ${totalInterest.toLocaleString()}
                </div>`;
            }
            
            // Sonhos
            if (player.dreams.length > 0) {
                html += `<h4 style="color: #f39c12; margin-top: 20px; border-bottom: 2px solid #f39c12; padding-bottom: 5px;">SONHOS REALIZADOS</h4>`;
                player.dreams.forEach(dream => {
                    html += `<p>‚≠ê ${dream}</p>`;
                });
            }
            
            document.getElementById('assetsContent').innerHTML = html;
            document.getElementById('assetsTitle').textContent = `${player.name} - Situa√ß√£o Financeira`;
            document.getElementById('assetsModal').style.display = 'flex';
        }

        // =========== FUN√á√ïES AUXILIARES ===========
        function addLog(message) {
            const log = document.getElementById('gameLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = message;
            log.prepend(entry);
            
            if (log.children.length > 30) {
                log.removeChild(log.lastChild);
            }
        }

        function clearLog() {
            document.getElementById('gameLog').innerHTML = '<div class="log-entry">Hist√≥rico limpo</div>';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // =========== INICIALIZAR ===========
        document.addEventListener('DOMContentLoaded', initializeGame);
    </script>
</body>
</html>